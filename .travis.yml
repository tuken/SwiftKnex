os:
  - linux
  - osx
language: generic
sudo: required
dist: xenial
osx_image: xcode9.2
services:
  - mysql

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install mysql@5.7; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew services start mysql@5.7; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew link mysql@5.7 --force; fi
  - mysql -uroot -e 'CREATE DATABASE IF NOT EXISTS swift_knex_test;'

install:
  - source Scripts/install-swift.sh

script:
  - mysql --version
  - swift --version
  - swift build
  - swift build -c release
  - swift test
