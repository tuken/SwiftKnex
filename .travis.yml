os:
  - linux
  - osx
language: generic
sudo: required
dist: trusty
osx_image: xcode9.2

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sh Scripts/install-mysql-5.7.sh; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install mysql@5.7; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew services start mysql@5.7; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then echo 'export PATH="/usr/local/opt/mysql@5.7/bin:$PATH"' >> ~/.bash_profile; fi
  - mysql -uroot -e 'CREATE DATABASE swift_knex_test;'

install:
  - source Scripts/install-swift.sh

script:
  - mysql --version
  - swift --version
  - swift build
  - swift build -c release
  - swift test
